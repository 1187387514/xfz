function FrontBase(){}function Auth(){var t=this;t.markWrapper=$(".mark-wrapper"),t.scrollWrapper=$(".auth-scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){this.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth_box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.showEvent=function(){this.markWrapper.show()},Auth.prototype.hideEvent=function(){this.markWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".close-btn"),e=$(".signin-btn"),o=$(".signup-btn");console.log(5),e.click(function(){console.log(1),t.showEvent(),t.scrollWrapper.css({left:0})}),o.click(function(){console.log(2),t.showEvent(),t.scrollWrapper.css({left:-400})}),n.click(function(){console.log(3),t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400"})})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.unbind("click");var n=10,e=setInterval(function(){t.smsCaptcha.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smsCaptcha.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){(t.code=200)&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group"),t=f.find(".submit-btn");console.log("f"),t.click(function(t){console.log("e"),t.preventDefault();var n=f.find("input[name='telephone']"),e=f.find("input[name='username']"),o=f.find("input[name='img_captcha']"),s=f.find("input[name='password1']"),a=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),r=n.val(),c=e.val(),p=o.val(),u=s.val(),l=a.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:r,username:c,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){200==t.code&&window.location.reload()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSigninEvent=function(){var s=this,t=$(".signin-group"),n=t.find("input[name='telephone']"),e=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){telephone=n.val(),password=e.val(),remember=o.prop("checked"),xfzajax.post({url:"/account/login/",data:{telephone:telephone,password:password,remember:remember?1:0},success:function(t){if(200==t.code)s.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var o=n[e][0];window.messageBox.show(o)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenImageCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenSignupEvent(),t.listenImageCaptchaEvent(),t.listenSmsCaptchaEvent()},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(window.template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),o=((new Date).getTime()-e)/1e3;if(console.log(o),o<60)return"刚刚";if(60<=o&&o<3600)return minutes=parseInt(o/60),minutes+"分钟前";if(3600<=o&&o<86400)return hours=parseInt(o/60/60),hours+"小时前";if(86400<=o&&o<2592e3)return days=parseInt(o/60/60/24),days+"天前";var s=n.getFullYear(),a=n.getMonth(),i=n.getDay(),r=(n.getHours(),n.getMinutes());return s+"/"+a+"/"+i+" "+hours+":"+r})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFya1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGEiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50IiwibGlzdGVuU2hvd0hpZGVFdmVudCIsImNsb3NlQnRuIiwic2lnbmluQnRuIiwic2lnbnVwQnRuIiwiY29uc29sZSIsImxvZyIsImNsaWNrIiwiY3NzIiwibGVmdCIsImxpc3RlblN3aXRjaEV2ZW50IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJzbXNTdWNjZXNzRXZlbnQiLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJ1bmJpbmQiLCJjb3VudCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsInRlbGVwaG9uZUlucHV0IiwidGVsZXBob25lIiwidmFsIiwic2hvd0luZm8iLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJmYWlsIiwiZXJyb3IiLCJsaXN0ZW5TaWdudXBFdmVudCIsInNpZ251cEdyb3VwIiwic3VibWl0QnRuIiwiZmluZCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VybmFtZUlucHV0IiwiaW1nQ2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc0NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsInBvc3QiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImxpc3RlblNpZ25pbkV2ZW50Iiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbm5wdXQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwia2V5IiwibWVzc2FnZSIsImxpc3RlbkltYWdlQ2FwdGNoYUV2ZW50IiwiaW1nQ2FwdGNoYSIsImF0dHIiLCJNYXRoIiwicmFuZG9tIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJtaW51dGVzIiwiaG91cnMiLCJkYXlzIiwieWVhciIsImdldEZ1bGxZZWFyIiwibW9udGgiLCJnZXRNb250aCIsImRheSIsImdldERheSIsIm1pbnV0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBRUEsU0FBU0EsYUFrQlQsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsd0JBQ3ZCSCxFQUFLSyxXQUFhRixFQUFFLG9CQXBCeEJMLFVBQVVRLFVBQVVDLElBQU0sV0FDWE4sS0FDTk8sc0JBR1RWLFVBQVVRLFVBQVVFLG1CQUFxQixXQUNyQyxJQUFJQyxFQUFVTixFQUFFLGFBQ1pPLEVBQWNQLEVBQUUsa0JBQ3BCTSxFQUFRRSxNQUFNLFdBQ1ZELEVBQVlFLFFBQ2QsV0FDRUYsRUFBWUcsVUFZcEJkLEtBQUtPLFVBQVVRLFVBQVksV0FDWmIsS0FDTkMsWUFBWVUsUUFHckJiLEtBQUtPLFVBQVVTLFVBQVksV0FDWmQsS0FDTkMsWUFBWVcsUUFHckJkLEtBQUtPLFVBQVVVLG9CQUFzQixXQUNqQyxJQUFJaEIsRUFBT0MsS0FDUGdCLEVBQVdkLEVBQUUsY0FDYmUsRUFBWWYsRUFBRSxlQUNkZ0IsRUFBWWhCLEVBQUUsZUFD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QyxJQUFJLEdBQ1I2RSxFQUFZLEdBQ1osTUFBTyxLQUNMLEdBQWdCLElBQWJBLEdBQW1CQSxFQUFZLEtBRXhDLE9BRElDLFFBQVV4RSxTQUFTdUUsRUFBWSxJQUM1QkMsUUFBUyxNQUNWLEdBQWdCLE1BQWJELEdBQXdCQSxFQUFZLE1BRTdDLE9BRElFLE1BQVF6RSxTQUFTdUUsRUFBWSxHQUFLLElBQy9CRSxNQUFNLE1BQ1AsR0FBaUIsT0FBYkYsR0FBNkJBLEVBQVksT0FFbkQsT0FESUcsS0FBTzFFLFNBQVN1RSxFQUFZLEdBQUssR0FBSyxJQUNuQ0csS0FBTSxLQUVULElBQUlDLEVBQU9SLEVBQUtTLGNBQ1pDLEVBQVFWLEVBQUtXLFdBQ2JDLEVBQU1aLEVBQUthLFNBRVhDLEdBRE9kLEVBQUtlLFdBQ0hmLEVBQUtnQixjQUNsQixPQUFPUixFQUFPLElBQU1FLEVBQVEsSUFBTUUsRUFBTSxJQUFNTixNQUFRLElBQU1RIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy/nlKjmnaXlpITnkIblr7zoiKrmnaFcclxuXHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHt9XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKCk7XHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJCgnLmF1dGhfYm94Jyk7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKCcudXNlci1tb3JlLWJveCcpO1xyXG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpO1xyXG4gICAgfSxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vL+eUqOadpeWkhOeQhueZu+mZhuWSjOazqOWGjOeahFxyXG5mdW5jdGlvbiBBdXRoKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hcmtXcmFwcGVyID0gJCgnLm1hcmstd3JhcHBlcicpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJCgnLmF1dGgtc2Nyb2xsLXdyYXBwZXInKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXJrV3JhcHBlci5zaG93KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hcmtXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSAkKCcuY2xvc2UtYnRuJyk7XHJcbiAgICB2YXIgc2lnbmluQnRuID0gJCgnLnNpZ25pbi1idG4nKTtcclxuICAgIHZhciBzaWdudXBCdG4gPSAkKCcuc2lnbnVwLWJ0bicpO1xyXG4gICAgY29uc29sZS5sb2coNSk7XHJcblxyXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygxKTtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoeydsZWZ0JzowfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKDIpO1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOi00MDB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygzKTtcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoZXIgPSAkKCcuc3dpdGNoJyk7XHJcbiAgICBzd2l0Y2hlci5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcygnbGVmdCcpO1xyXG4gICAgICAgIGN1cnJlbnRMZWZ0ID0gcGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4gICAgICAgIGlmKGN1cnJlbnRMZWZ0PDApe1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7J2xlZnQnOicwJ30pXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHsnbGVmdCc6Jy00MDAnfSlcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIG1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+efreS/oemqjOivgeeggeWPkemAgeaIkOWKn++8gScpO1xyXG4gICAgLy8gc2VsZi5zbXNDYXB0Y2hhLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLnVuYmluZCgnY2xpY2snKTtcclxuICAgIHZhciBjb3VudCA9IDEwO1xyXG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KGNvdW50KydzJyk7XHJcbiAgICAgICAgY291bnQtPTE7XHJcbiAgICAgICAgaWYgKGNvdW50PD0wKXtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XHJcbiAgICAgICAgICAgIC8vIHNlbGYuc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sMTAwMClcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSAkKFwiLnNpZ251cC1ncm91cCBpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIGlmKCF0ZWxlcGhvbmUpe1xyXG4gICAgICAgICAgICBtZXNzYWdlQm94LnNob3dJbmZvKCfor7fovpPlhaXmiYvmnLrlj7fnoIEnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJyA6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxyXG4gICAgICAgICAgICAnZGF0YScgOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJyA6IHRlbGVwaG9uZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2VzcycgOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnIDogZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbnVwRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xyXG4gICAgY29uc29sZS5sb2coJ2YnKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZScpO1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XHJcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvcmVnaXN0ZXIvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbm5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcclxuXHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbm5wdXQudmFsKCk7XHJcbiAgICAgICAgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpO1xyXG4gICAgICAgIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOnBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzpyZW1lbWJlcj8xOjAsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT0yMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VPYmplY3QgPSByZXN1bHRbJ21lc3NhZ2UnXTtcclxuICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgbWVzc2FnZU9iamVjdCA9PSdzdHJpbmcnfHxtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yPT1TdHJpbmcpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6ZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlbkltYWdlQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICB2YXIgaW1nQ2FwdGNoYSA9ICQoJy5pbWctY2FwdGNoYScpO1xyXG4gIGltZ0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICBpbWdDYXB0Y2hhLmF0dHIoJ3NyYycsJy9hY2NvdW50L2ltZ19jYXB0Y2hhLycrJz9yYW5kb209JytNYXRoLnJhbmRvbSgpKTtcclxuICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ251cEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltYWdlQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG5cclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICBpZih3aW5kb3cudGVtcGxhdGUpe1xyXG4gICAgICAgIHdpbmRvdy50ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGRhdGVWYWx1ZSk7XHJcbiAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpO1xyXG4gICAgICAgIHZhciBub3d0cyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IChub3d0cyAtIGRhdGV0cykvMTAwMDtcclxuICAgICAgICBjb25zb2xlLmxvZygodGltZXN0YW1wKSk7XHJcbiAgICAgICAgaWYgKHRpbWVzdGFtcCA8IDYwKXtcclxuICAgICAgICAgICAgcmV0dXJuICfliJrliJonXHJcbiAgICAgICAgfWVsc2UgaWYodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjApe1xyXG4gICAgICAgICAgICBtaW51dGVzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjApO1xyXG4gICAgICAgIHJldHVybiBtaW51dGVzKyAn5YiG6ZKf5YmNJ1xyXG4gICAgICAgIH1lbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCAqIDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCl7XHJcbiAgICAgICAgICAgIGhvdXJzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCk7XHJcbiAgICAgICAgcmV0dXJuIGhvdXJzKyflsI/ml7bliY0nXHJcbiAgICAgICAgfWVsc2UgaWYoIHRpbWVzdGFtcCA+PSA2MCAqIDYwICogMjQgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCAqIDI0ICogMzApe1xyXG4gICAgICAgICAgICBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCAvIDI0KTtcclxuICAgICAgICByZXR1cm4gZGF5cysgJ+WkqeWJjSdcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB5ZWFyICsgJy8nICsgbW9udGggKyAnLycgKyBkYXkgKyAnICcgKyBob3VycyArICc6JyArIG1pbnV0ZVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB9XHJcbn0pOyJdfQ==
