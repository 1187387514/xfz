function Banner(){this.bannerWidth=798,this.bannerGroup=$("#banner-group"),this.index=1,this.left_arrow=$("#left-arrow"),this.right_arrow=$("#right-arrow"),this.bannerUl=$("#banner-ul"),this.banner_li_list=this.bannerUl.children("li"),this.banner_li_count=this.banner_li_list.length,this.pageControl=$(".page-control")}function Index(){this.page=2,this.category_id=0,this.loadBtn=$("#load-more-btn"),template.defaults.imports.timeSince=function(n){var e=new Date(n),t=e.getTime(),i=((new Date).getTime()-t)/1e3;return i<60?"刚刚":60<=i&&i<3600?(minutes=parseInt(i/60),minutes+"分钟前"):3600<=i&&i<86400?(hours=parseInt(i/60/60),hours+"小时前"):86400<=i&&i<2592e3?(days=parseInt(i/60/60/24),days+"天前"):e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+":"+e.getMinutes()}}Banner.prototype.listenPageControl=function(){var t=this;t.pageControl.children("li").each(function(n,e){$(e).click(function(){t.index=n+1,t.animate()})})},Banner.prototype.initPageControl=function(){for(var n=this,e=0;e<n.banner_li_count;e++){var t=$("<li></li>");n.pageControl.append(t),0===e&&t.addClass("active")}n.pageControl.css({width:10*n.banner_li_count+16+16*(n.banner_li_count-1)})},Banner.prototype.initBanner=function(){var n=this;n.bannerUl.css({width:n.bannerWidth*n.banner_li_count,left:-n.bannerWidth*n.index});var e=n.banner_li_list.eq(0).clone(),t=n.banner_li_list.eq(n.banner_li_count-1).clone();n.bannerUl.append(e),n.bannerUl.prepend(t),n.bannerUl.css({width:n.bannerWidth*(n.banner_li_count+2)})},Banner.prototype.animate=function(){var n=this;this.bannerUl.stop().animate({left:-798*this.index},500),n.index<=0?this.pageControl.children("li").eq(n.banner_li_count-1).addClass("active").siblings().removeClass("active"):n.index>=n.banner_li_count+1?this.pageControl.children("li").eq(0).addClass("active").siblings().removeClass("active"):this.pageControl.children("li").eq(n.index-1).addClass("active").siblings().removeClass("active")},Banner.prototype.listenArrowClick=function(){var n=this;n.left_arrow.click(function(){0===n.index?(n.bannerUl.css({left:-n.bannerWidth*n.banner_li_count}),n.index=n.banner_li_count-1):n.index--,n.animate()}),n.right_arrow.click(function(){n.index===n.banner_li_count+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=1):n.index++,n.animate()})},Banner.prototype.toggleArrow=function(n){var e=this;n?(e.left_arrow.show(),e.right_arrow.show()):(e.left_arrow.hide(),e.right_arrow.hide())},Banner.prototype.loop=function(){var n=this;this.timer=setInterval(function(){n.index>=n.banner_li_count+1?(n.index=2,n.bannerUl.css({left:-n.bannerWidth*(n.index-1)})):n.index++,n.animate()},2500)},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){clearInterval(n.timer),n.toggleArrow(!0),console.log(n.timer)},function(){n.loop(),n.toggleArrow(!1)})},Banner.prototype.run=function(){this.initBanner(),this.initPageControl(),this.loop(),this.listenBannerHover(),this.toggleArrow(!1),this.listenArrowClick(),this.listenPageControl()},Index.prototype.run=function(){this.listenLoadMoreEvent(),this.listenCategorySwitchEvent()},Index.prototype.listenCategorySwitchEvent=function(){var o=this;$(".list-tab").children().click(function(){var r=$(this),a=r.attr("data-category");xfzajax.get({url:"/news/news_list/",data:{p:1,category_id:a},success:function(n){if(200===n.code){var e=n.data,t=template("news-item",{newses:e}),i=$(".list-inner-group");i.empty(),i.append(t),o.loadBtn.show(),r.addClass("active").siblings().removeClass("active"),o.page=2,o.category_id=a}}})})},Index.prototype.listenLoadMoreEvent=function(){var i=this;i.loadBtn.click(function(){xfzajax.get({url:"/news/news_list/",data:{p:i.page,category_id:i.category_id},success:function(n){if(200===n.code){var e=n.data;if(0<e.length){var t=template("news-item",{newses:e});$(".list-inner-group").append(t),i.page+=1}else i.loadBtn.hide()}}})})},$(function(){var n=new Banner,e=new Index;n.run(),e.run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkJhbm5lciIsInRoaXMiLCJiYW5uZXJXaWR0aCIsImJhbm5lckdyb3VwIiwiJCIsImluZGV4IiwibGVmdF9hcnJvdyIsInJpZ2h0X2Fycm93IiwiYmFubmVyVWwiLCJiYW5uZXJfbGlfbGlzdCIsImNoaWxkcmVuIiwiYmFubmVyX2xpX2NvdW50IiwibGVuZ3RoIiwicGFnZUNvbnRyb2wiLCJJbmRleCIsInBhZ2UiLCJjYXRlZ29yeV9pZCIsImxvYWRCdG4iLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVTaW5jZSIsImRhdGVWYWx1ZSIsImRhdGUiLCJEYXRlIiwiZGF0ZXMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwibWludXRlcyIsInBhcnNlSW50IiwiaG91cnMiLCJkYXlzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsInByb3RvdHlwZSIsImxpc3RlblBhZ2VDb250cm9sIiwic2VsZiIsImVhY2giLCJvYmoiLCJjbGljayIsImFuaW1hdGUiLCJpbml0UGFnZUNvbnRyb2wiLCJpIiwiY2lyY2xlIiwiYXBwZW5kIiwiYWRkQ2xhc3MiLCJjc3MiLCJ3aWR0aCIsImluaXRCYW5uZXIiLCJsZWZ0IiwiZmlyc3RQYWdlIiwiZXEiLCJjbG9uZSIsImxhc3RQYWdlIiwicHJlcGVuZCIsInN0b3AiLCJzaWJsaW5ncyIsInJlbW92ZUNsYXNzIiwibGlzdGVuQXJyb3dDbGljayIsInRvZ2dsZUFycm93IiwiaXNTaG93Iiwic2hvdyIsImhpZGUiLCJsb29wIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsImxpc3RlbkJhbm5lckhvdmVyIiwiaG92ZXIiLCJjbGVhckludGVydmFsIiwiY29uc29sZSIsImxvZyIsInJ1biIsImxpc3RlbkxvYWRNb3JlRXZlbnQiLCJsaXN0ZW5DYXRlZ29yeVN3aXRjaEV2ZW50IiwibGkiLCJhdHRyIiwieGZ6YWpheCIsImdldCIsInVybCIsImRhdGEiLCJwIiwic3VjY2VzcyIsInJlcyIsIm5ld3NlcyIsInRwbCIsIm5ld3NMaXN0R3JvdXAiLCJlbXB0eSIsImJhbm5lciJdLCJtYXBwaW5ncyI6IkFBRUEsU0FBU0EsU0FDTEMsS0FBS0MsWUFBYyxJQUNuQkQsS0FBS0UsWUFBY0MsRUFBRSxpQkFDckJILEtBQUtJLE1BQVEsRUFDYkosS0FBS0ssV0FBYUYsRUFBRSxlQUNwQkgsS0FBS00sWUFBY0gsRUFBRSxnQkFDckJILEtBQUtPLFNBQVlKLEVBQUUsY0FDbkJILEtBQUtRLGVBQWlCUixLQUFLTyxTQUFTRSxTQUFTLE1BQzdDVCxLQUFLVSxnQkFBa0JWLEtBQUtRLGVBQWVHLE9BQzNDWCxLQUFLWSxZQUFjVCxFQUFFLGlCQXdIekIsU0FBU1UsUUFFTGIsS0FBS2MsS0FBTyxFQUNaZCxLQUFLZSxZQUFjLEVBRlJmLEtBR05nQixRQUFVYixFQUFFLGtCQUNqQmMsU0FBU0MsU0FBU0MsUUFBUUMsVUFBWSxTQUFTQyxHQUMzQyxJQUFJQyxFQUFPLElBQUlDLEtBQUtGLEdBQ2hCRyxFQUFRRixFQUFLRyxVQUViQyxJQURPLElBQUtILE1BQVFFLFVBQ0FELEdBQU8sSUFDL0IsT0FBR0UsRUFBWSxHQUNKLEtBQ1csSUFBYkEsR0FBbUJBLEVBQVksTUFDcENDLFFBQVVDLFNBQVNGLEVBQVksSUFDeEJDLFFBQVEsT0FDRyxNQUFiRCxHQUF3QkEsRUFBWSxPQUN6Q0csTUFBUUQsU0FBU0YsRUFBWSxHQUFLLElBQzNCRyxNQUFNLE9BQ0ssT0FBYkgsR0FBNkJBLEVBQVksUUFDOUNJLEtBQU9GLFNBQVNGLEVBQVksR0FBSyxHQUFLLElBQy9CSSxLQUFLLE1BRURSLEVBQUtTLGNBS0osSUFKQVQsRUFBS1UsV0FJSyxJQUhaVixFQUFLVyxTQUdlLElBRm5CWCxFQUFLWSxXQUV1QixJQUQxQlosRUFBS2EsY0EvSTlCcEMsT0FBT3FDLFVBQVVDLGtCQUFrQixXQUMvQixJQUFJQyxFQUFPdEMsS0FDWHNDLEVBQUsxQixZQUFZSCxTQUFTLE1BQU04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Q1hzQyxFQUFLdEIsUUFBUXlCLE1BQU0sV0FDZnFDLFFBQVFDLElBQUksQ0FDUkMsSUFBTyxtQkFDUEMsS0FBUSxDQUNKQyxFQUFLNUMsRUFBS3hCLEtBQ1ZDLFlBQWN1QixFQUFLdkIsYUFFdkJvRSxRQUFXLFNBQVVDLEdBQ2pCLEdBQW9CLE1BQWhCQSxFQUFVLEtBQVcsQ0FDckIsSUFBSUMsRUFBU0QsRUFBVSxLQUN2QixHQUFvQixFQUFoQkMsRUFBTzFFLE9BQVksQ0FDbkIsSUFBSTJFLEVBQU1yRSxTQUFTLFlBQWEsQ0FDNUJvRSxPQUFVQSxJQUVMbEYsRUFBRSxxQkFDUjJDLE9BQU93QyxHQUNWaEQsRUFBS3hCLE1BQU0sT0FFWHdCLEVBQUt0QixRQUFRZ0QsY0FTckM3RCxFQUFFLFdBRUUsSUFBSXNGLEVBQVMsSUFBSTFGLE9BQ2JLLEVBQVEsSUFBSVMsTUFDaEI0RSxFQUFPaEIsTUFDUHJFLEVBQU1xRSIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmZ1bmN0aW9uIEJhbm5lcigpIHtcclxuICAgIHRoaXMuYmFubmVyV2lkdGggPSA3OTg7XHJcbiAgICB0aGlzLmJhbm5lckdyb3VwID0gJCgnI2Jhbm5lci1ncm91cCcpO1xyXG4gICAgdGhpcy5pbmRleCA9IDE7XHJcbiAgICB0aGlzLmxlZnRfYXJyb3cgPSAkKCcjbGVmdC1hcnJvdycpO1xyXG4gICAgdGhpcy5yaWdodF9hcnJvdyA9ICQoJyNyaWdodC1hcnJvdycpO1xyXG4gICAgdGhpcy5iYW5uZXJVbCA9ICAkKCcjYmFubmVyLXVsJyk7XHJcbiAgICB0aGlzLmJhbm5lcl9saV9saXN0ID0gdGhpcy5iYW5uZXJVbC5jaGlsZHJlbignbGknKTtcclxuICAgIHRoaXMuYmFubmVyX2xpX2NvdW50ID0gdGhpcy5iYW5uZXJfbGlfbGlzdC5sZW5ndGg7XHJcbiAgICB0aGlzLnBhZ2VDb250cm9sID0gJCgnLnBhZ2UtY29udHJvbCcpO1xyXG59XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmxpc3RlblBhZ2VDb250cm9sPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnBhZ2VDb250cm9sLmNoaWxkcmVuKCdsaScpLmVhY2goZnVuY3Rpb24oaW5kZXgsb2JqKXtcclxuICAgICAgICAkKG9iaikuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gaW5kZXgrMTtcclxuICAgICAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5pbml0UGFnZUNvbnRyb2wgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgZm9yKHZhciBpPTA7aTxzZWxmLmJhbm5lcl9saV9jb3VudDtpKyspe1xyXG4gICAgICAgIHZhciBjaXJjbGUgPSAkKCc8bGk+PC9saT4nKTtcclxuICAgICAgICBzZWxmLnBhZ2VDb250cm9sLmFwcGVuZChjaXJjbGUpO1xyXG4gICAgICAgIGlmKGkgPT09IDApe1xyXG4gICAgICAgICAgICBjaXJjbGUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY3NzKHsnd2lkdGgnOjEwKnNlbGYuYmFubmVyX2xpX2NvdW50KyAxNiArMTYqKHNlbGYuYmFubmVyX2xpX2NvdW50LTEpfSk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmluaXRCYW5uZXIgPWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmJhbm5lclVsLmNzcyh7J3dpZHRoJzpzZWxmLmJhbm5lcldpZHRoKnNlbGYuYmFubmVyX2xpX2NvdW50LFxyXG4gICAgICAgICdsZWZ0Jzotc2VsZi5iYW5uZXJXaWR0aCpzZWxmLmluZGV4fSk7XHJcbiAgICB2YXIgZmlyc3RQYWdlID0gc2VsZi5iYW5uZXJfbGlfbGlzdC5lcSgwKS5jbG9uZSgpO1xyXG4gICAgdmFyIGxhc3RQYWdlID0gc2VsZi5iYW5uZXJfbGlfbGlzdC5lcShzZWxmLmJhbm5lcl9saV9jb3VudC0xKS5jbG9uZSgpO1xyXG4gICAgc2VsZi5iYW5uZXJVbC5hcHBlbmQoZmlyc3RQYWdlKTtcclxuICAgIHNlbGYuYmFubmVyVWwucHJlcGVuZChsYXN0UGFnZSk7XHJcbiAgICBzZWxmLmJhbm5lclVsLmNzcyh7J3dpZHRoJzpzZWxmLmJhbm5lcldpZHRoKihzZWxmLmJhbm5lcl9saV9jb3VudCsyKX0pO1xyXG59O1xyXG5cclxuXHJcbkJhbm5lci5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLmJhbm5lclVsLnN0b3AoKS5hbmltYXRlKHsnbGVmdCc6LTc5OCp0aGlzLmluZGV4fSw1MDApO1xyXG4gICAgaWYoc2VsZi5pbmRleCA8PSAwKXtcclxuICAgICAgICB0aGlzLnBhZ2VDb250cm9sLmNoaWxkcmVuKCdsaScpLmVxKHNlbGYuYmFubmVyX2xpX2NvdW50LTEpLmFkZENsYXNzKCdhY3RpdmUnKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgIH1lbHNlIGlmKHNlbGYuaW5kZXggPj0gc2VsZi5iYW5uZXJfbGlfY291bnQrMSl7XHJcbiAgICAgICAgdGhpcy5wYWdlQ29udHJvbC5jaGlsZHJlbignbGknKS5lcSgwKS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICB0aGlzLnBhZ2VDb250cm9sLmNoaWxkcmVuKCdsaScpLmVxKHNlbGYuaW5kZXgtMSkuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5saXN0ZW5BcnJvd0NsaWNrID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGVmdF9hcnJvdy5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYoc2VsZi5pbmRleCA9PT0gMCl7XHJcbiAgICAgICAgICAgIHNlbGYuYmFubmVyVWwuY3NzKHsnbGVmdCc6LXNlbGYuYmFubmVyV2lkdGgqc2VsZi5iYW5uZXJfbGlfY291bnR9KTtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IHNlbGYuYmFubmVyX2xpX2NvdW50LTE7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXgtLTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICB9KTtcclxuICAgIHNlbGYucmlnaHRfYXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHNlbGYuaW5kZXggPT09IHNlbGYuYmFubmVyX2xpX2NvdW50KzEpe1xyXG4gICAgICAgICAgICBzZWxmLmJhbm5lclVsLmNzcyh7J2xlZnQnOi1zZWxmLmJhbm5lcldpZHRofSk7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXggPSAxO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ICsrXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgfSlcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUudG9nZ2xlQXJyb3c9ZnVuY3Rpb24oaXNTaG93KXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIGlmKGlzU2hvdyl7XHJcbiAgICAgICAgc2VsZi5sZWZ0X2Fycm93LnNob3coKTtcclxuICAgICAgICBzZWxmLnJpZ2h0X2Fycm93LnNob3coKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIHNlbGYubGVmdF9hcnJvdy5oaWRlKCk7XHJcbiAgICAgICAgc2VsZi5yaWdodF9hcnJvdy5oaWRlKCk7XHJcbiAgICB9XHJcbn07XHJcbkJhbm5lci5wcm90b3R5cGUubG9vcCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHNlbGYuaW5kZXggPj0gKHNlbGYuYmFubmVyX2xpX2NvdW50KzEpKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXggPSAyO1xyXG4gICAgICAgICAgICBzZWxmLmJhbm5lclVsLmNzcyh7J2xlZnQnOi1zZWxmLmJhbm5lcldpZHRoKihzZWxmLmluZGV4LTEpfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWxmLmluZGV4KTtcclxuICAgICAgICBzZWxmLmFuaW1hdGUoKTt9LDI1MDBcclxuICAgICl9O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5saXN0ZW5CYW5uZXJIb3Zlcj1mdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5iYW5uZXJHcm91cC5ob3ZlcihmdW5jdGlvbigpe1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoc2VsZi50aW1lcik7XHJcbiAgICAgICAgc2VsZi50b2dnbGVBcnJvdyh0cnVlKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnRpbWVyKTtcclxuICAgIH0sZnVuY3Rpb24oKXtcclxuICAgICAgICBzZWxmLmxvb3AoKTtcclxuICAgICAgICBzZWxmLnRvZ2dsZUFycm93KGZhbHNlKVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uKCl7XHJcbiAgICB0aGlzLmluaXRCYW5uZXIoKTtcclxuICAgIHRoaXMuaW5pdFBhZ2VDb250cm9sKCk7XHJcbiAgICB0aGlzLmxvb3AoKTtcclxuICAgIHRoaXMubGlzdGVuQmFubmVySG92ZXIoKTtcclxuICAgIHRoaXMudG9nZ2xlQXJyb3coZmFsc2UpO1xyXG4gICAgdGhpcy5saXN0ZW5BcnJvd0NsaWNrKCk7XHJcbiAgICB0aGlzLmxpc3RlblBhZ2VDb250cm9sKCk7XHJcblxyXG59O1xyXG5cclxuZnVuY3Rpb24gSW5kZXgoKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMucGFnZSA9IDI7XHJcbiAgICB0aGlzLmNhdGVnb3J5X2lkID0gMDtcclxuICAgIHNlbGYubG9hZEJ0biA9ICQoJyNsb2FkLW1vcmUtYnRuJyk7XHJcbiAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uKGRhdGVWYWx1ZSl7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgIHZhciBkYXRlcyA9IGRhdGUuZ2V0VGltZSgpO1xyXG4gICAgICAgIHZhciBub3dzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3MgLSBkYXRlcykvMTAwMDtcclxuICAgICAgICBpZih0aW1lc3RhbXAgPCA2MCl7XHJcbiAgICAgICAgICAgIHJldHVybiAn5Yia5YiaJztcclxuICAgICAgICB9ZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICBtaW51dGVzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjApO1xyXG4gICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcclxuICAgICAgICB9ZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgKiA2MCAmJiB0aW1lc3RhbXAgPCA2MCAqIDYwICogMjQpe1xyXG4gICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xyXG4gICAgICAgICAgICByZXR1cm4gaG91cnMrJ+Wwj+aXtuWJjSc7XHJcbiAgICAgICAgfWVsc2UgaWYodGltZXN0YW1wID49IDYwICogNjAgKiAyNCAmJiB0aW1lc3RhbXAgPCA2MCAqIDYwICogMjQgKiAzMCl7XHJcbiAgICAgICAgICAgIGRheXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwIC8gMjQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF5cysn5aSp5YmNJztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5KycgJytob3VyKyc6JyttaW51dGU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuSW5kZXgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlbkxvYWRNb3JlRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuQ2F0ZWdvcnlTd2l0Y2hFdmVudCgpO1xyXG59O1xyXG5cclxuSW5kZXgucHJvdG90eXBlLmxpc3RlbkNhdGVnb3J5U3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHRhYkdyb3VwID0gJCgnLmxpc3QtdGFiJyk7XHJcbiAgICB0YWJHcm91cC5jaGlsZHJlbigpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbGkgPSAkKHRoaXMpO1xyXG4gICAgICAgIHZhciBwYWdlID0gMTtcclxuICAgICAgICB2YXIgY2F0ZWdvcnlfaWQgPSBsaS5hdHRyKCdkYXRhLWNhdGVnb3J5Jyk7XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzonL25ld3MvbmV3c19saXN0LycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAncCc6cGFnZSxcclxuICAgICAgICAgICAgICAgICdjYXRlZ29yeV9pZCc6Y2F0ZWdvcnlfaWRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc1snY29kZSddPT09MjAwKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3c2VzID0gcmVzWydkYXRhJ107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRwbCA9IHRlbXBsYXRlKCduZXdzLWl0ZW0nLHsnbmV3c2VzJzpuZXdzZXN9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3c0xpc3RHcm91cCA9ICQoJy5saXN0LWlubmVyLWdyb3VwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3c0xpc3RHcm91cC5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld3NMaXN0R3JvdXAuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2FkQnRuLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICBsaS5hZGRDbGFzcygnYWN0aXZlJykuc2libGluZ3MoKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhdGVnb3J5X2lkID0gY2F0ZWdvcnlfaWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuSW5kZXgucHJvdG90eXBlLmxpc3RlbkxvYWRNb3JlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5sb2FkQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL25ld3MvbmV3c19saXN0LycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ3AnOiBzZWxmLnBhZ2UsXHJcbiAgICAgICAgICAgICAgICAnY2F0ZWdvcnlfaWQnOnNlbGYuY2F0ZWdvcnlfaWRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzWydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdzZXMgPSByZXNbJ2RhdGEnXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3c2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRwbCA9IHRlbXBsYXRlKCduZXdzLWl0ZW0nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmV3c2VzJzogbmV3c2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdWwgPSAkKCcubGlzdC1pbm5lci1ncm91cCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bC5hcHBlbmQodHBsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlKz0xO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZEJ0bi5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKVxyXG4ge1xyXG4gICAgdmFyIGJhbm5lciA9IG5ldyBCYW5uZXIoKTtcclxuICAgIHZhciBpbmRleCA9IG5ldyBJbmRleCgpO1xyXG4gICAgYmFubmVyLnJ1bigpO1xyXG4gICAgaW5kZXgucnVuKCk7XHJcblxyXG59KTsiXX0=
