function Banners(){}Banners.prototype.run=function(){this.listenAddBannerEvent(),this.loadData()},$(function(){(new Banners).run()}),Banners.prototype.listenAddBannerEvent=function(){var t=this;$("#add-banner-btn").click(function(){var n=$(".banner-list-group"),e=template("banner-item");n.prepend(e);var a=n.find(".banner-item:first");t.addImageSelectEvent(a),t.addRemoveBannerEvent(a),t.addSaveBannerEvent(a)})},Banners.prototype.addImageSelectEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.addRemoveBannerEvent=function(e){var n=e.find(".close-btn"),a=e.attr("data-banner-id");n.click(function(){a?xfzalert.alertConfirm({text:"您确定要删除这个轮播图吗？",confirmCallback:function(){xfzajax.get({url:"/cms/delete_banner/",data:{banner_id:a},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功"))}})}}):e.remove()})},Banners.prototype.addSaveBannerEvent=function(r){var n=r.find(".save-btn"),i=r.find(".thumbnail"),o=r.find("input[name='priority']"),d=r.find("input[name='link_to']"),s=r.find("span[class='priority']"),c=r.attr("data-banner-id");n.click(function(){var n=i.attr("src"),e=d.val(),a=o.val(),t=c;xfzajax.post({url:"/cms/add_banner/",data:{image_url:n,link_to:e,priority:a,pk:t},success:function(n){200===n.code&&(c?window.messageBox.showSuccess("轮播图修改成功"):(c=n.data.banner_id,r.attr({"data-banner-id":c}),window.messageBox.showSuccess("轮播图添加成功")),s.text("优先级："+a))}})})},Banners.prototype.loadData=function(){var a=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(n.code=200){var e=n.data;for(i=0;i<e.length;i++)banner=e[i],a.createBannerItem(banner)}}})},Banners.prototype.createBannerItem=function(n){var e=this,a=$(".banner-list-group"),t=template("banner-item",{banner:n}),r=null;r=n?(a.append(t),a.find(".banner-item:last")):(a.prepend(t),a.find(".banner-item:first")),e.addImageSelectEvent(r),e.addRemoveBannerEvent(r),e.addSaveBannerEvent(r)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsInJ1biIsInRoaXMiLCJsaXN0ZW5BZGRCYW5uZXJFdmVudCIsImxvYWREYXRhIiwiJCIsInNlbGYiLCJjbGljayIsImJhbm5lckxpc3RHcm91cCIsInRwbCIsInRlbXBsYXRlIiwicHJlcGVuZCIsImJhbm5lckl0ZW0iLCJmaW5kIiwiYWRkSW1hZ2VTZWxlY3RFdmVudCIsImFkZFJlbW92ZUJhbm5lckV2ZW50IiwiYWRkU2F2ZUJhbm5lckV2ZW50IiwiaW1hZ2UiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsInhmemFqYXgiLCJwb3N0IiwidXJsIiwiZGF0YSIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJzdWNjZXNzIiwicmVzIiwiYXR0ciIsImNsb3NlQnRuIiwiYmFubmVySWQiLCJ4ZnphbGVydCIsImFsZXJ0Q29uZmlybSIsInRleHQiLCJjb25maXJtQ2FsbGJhY2siLCJnZXQiLCJiYW5uZXJfaWQiLCJyZW1vdmUiLCJ3aW5kb3ciLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJzYXZlQnRuIiwiaW1hZ2VUYWciLCJwcmlvcml0eVRhZyIsImxpbmt0b1RhZyIsInByaW9yaXR5U3BhbiIsImltYWdlX3VybCIsImxpbmtfdG8iLCJ2YWwiLCJwcmlvcml0eSIsInBrIiwiZGF0YS1iYW5uZXItaWQiLCJiYW5uZXJzIiwiaSIsImxlbmd0aCIsImJhbm5lciIsImNyZWF0ZUJhbm5lckl0ZW0iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFdBSVRBLFFBQVFDLFVBQVVDLElBQU0sV0FDcEJDLEtBQUtDLHVCQUNMRCxLQUFLRSxZQUdUQyxFQUFFLFlBQ2dCLElBQUlOLFNBQ1ZFLFFBR1pGLFFBQVFDLFVBQVVHLHFCQUF1QixXQUNyQyxJQUFJRyxFQUFPSixLQUNFRyxFQUFFLG1CQUNSRSxNQUFN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QVFGLEdBQ1hELEVBQWdCSyxLQUFLLHVCQUV0Q1AsRUFBS1Esb0JBQW9CRixHQUN6Qk4sRUFBS1MscUJBQXFCSCxHQUMxQk4sRUFBS1UsbUJBQW1CSiIsImZpbGUiOiJiYW5uZXJzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEJhbm5lcnMoKSB7XHJcblxyXG59XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkFkZEJhbm5lckV2ZW50KCk7XHJcbiAgICB0aGlzLmxvYWREYXRhKCk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBiYW5uZXJzID0gbmV3IEJhbm5lcnMoKTtcclxuICAgIGJhbm5lcnMucnVuKCk7XHJcbn0pO1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUubGlzdGVuQWRkQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgYWRkQnRuID0gJChcIiNhZGQtYmFubmVyLWJ0blwiKTtcclxuICAgIGFkZEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJhbm5lckxpc3RHcm91cCA9ICQoJy5iYW5uZXItbGlzdC1ncm91cCcpO1xyXG4gICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZSgnYmFubmVyLWl0ZW0nKTtcclxuICAgICAgICBiYW5uZXJMaXN0R3JvdXAucHJlcGVuZCh0cGwpO1xyXG4gICAgICAgIHZhciBiYW5uZXJJdGVtID0gYmFubmVyTGlzdEdyb3VwLmZpbmQoJy5iYW5uZXItaXRlbTpmaXJzdCcpO1xyXG4gICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcclxuICAgICAgICBzZWxmLmFkZFJlbW92ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgICAgIHNlbGYuYWRkU2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgfSlcclxufTtcclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLmFkZEltYWdlU2VsZWN0RXZlbnQgPSBmdW5jdGlvbiAoYmFubmVySXRlbSkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGltYWdlID0gYmFubmVySXRlbS5maW5kKCcudGh1bWJuYWlsJyk7XHJcbiAgICB2YXIgaW1hZ2VJbnB1dCA9IGJhbm5lckl0ZW0uZmluZCgnLmltYWdlLWlucHV0Jyk7XHJcbiAgICBpbWFnZS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW1hZ2VJbnB1dC5jbGljaygpO1xyXG4gICAgfSk7XHJcbiAgICBpbWFnZUlucHV0LmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdO1xyXG4gICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsZmlsZSk7XHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6Jy9jbXMvdXBsb2FkX2ZpbGUvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOmZvcm1EYXRhLFxyXG4gICAgICAgICAgICAncHJvY2Vzc0RhdGEnOmZhbHNlLFxyXG4gICAgICAgICAgICAnY29udGVudFR5cGUnOmZhbHNlLFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgaWYocmVzWydjb2RlJ109PT0yMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXNbJ2RhdGEnXVsndXJsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UuYXR0cignc3JjJyx1cmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRSZW1vdmVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uIChiYW5uZXJJdGVtKSB7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSBiYW5uZXJJdGVtLmZpbmQoJy5jbG9zZS1idG4nKTtcclxuICAgIHZhciBiYW5uZXJJZCA9IGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnKTtcclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZihiYW5uZXJJZCl7XHJcbiAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSh7XHJcbiAgICAgICAgICAgICAgICAndGV4dCc6J+aCqOehruWumuimgeWIoOmZpOi/meS4qui9ruaSreWbvuWQl++8nycsXHJcbiAgICAgICAgICAgICAgICAnY29uZmlybUNhbGxiYWNrJzpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndXJsJzonL2Ntcy9kZWxldGVfYmFubmVyLycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmFubmVyX2lkJzpiYW5uZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzWydjb2RlJ109PT0yMDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0ucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+i9ruaSreWbvuWIoOmZpOaIkOWKnycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRTYXZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoYmFubmVySXRlbSkge1xyXG4gICAgdmFyIHNhdmVCdG4gPSBiYW5uZXJJdGVtLmZpbmQoJy5zYXZlLWJ0bicpO1xyXG4gICAgdmFyIGltYWdlVGFnID0gYmFubmVySXRlbS5maW5kKCcudGh1bWJuYWlsJyk7XHJcbiAgICB2YXIgcHJpb3JpdHlUYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdwcmlvcml0eSddXCIpO1xyXG4gICAgdmFyIGxpbmt0b1RhZyA9IGJhbm5lckl0ZW0uZmluZChcImlucHV0W25hbWU9J2xpbmtfdG8nXVwiKTtcclxuICAgIHZhciBwcmlvcml0eVNwYW4gPSBiYW5uZXJJdGVtLmZpbmQoXCJzcGFuW2NsYXNzPSdwcmlvcml0eSddXCIpO1xyXG4gICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xyXG4gICAgdmFyIHVybCA9ICcnO1xyXG4gICAgaWYoYmFubmVySWQpe1xyXG4gICAgICAgIHVybCA9ICcvY21zL2VkaXRfYmFubmVyLyc7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICB1cmwgPSAnL2Ntcy9hZGRfYmFubmVyLyc7XHJcbiAgICB9XHJcbiAgICBzYXZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW1hZ2VfdXJsID0gaW1hZ2VUYWcuYXR0cignc3JjJyk7XHJcbiAgICAgICAgdmFyIGxpbmtfdG8gPSBsaW5rdG9UYWcudmFsKCk7XHJcbiAgICAgICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdHlUYWcudmFsKCk7XHJcbiAgICAgICAgdmFyIHBrID0gYmFubmVySWQ7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOicvY21zL2FkZF9iYW5uZXIvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOntcclxuICAgICAgICAgICAgICAgICdpbWFnZV91cmwnOmltYWdlX3VybCxcclxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzpsaW5rX3RvLFxyXG4gICAgICAgICAgICAgICAgJ3ByaW9yaXR5Jzpwcmlvcml0eSxcclxuICAgICAgICAgICAgICAgICdwayc6cGtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc1snY29kZSddPT09MjAwKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihiYW5uZXJJZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfova7mkq3lm77kv67mlLnmiJDlip8nKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySWQgPSByZXNbJ2RhdGEnXVsnYmFubmVyX2lkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0uYXR0cih7J2RhdGEtYmFubmVyLWlkJzpiYW5uZXJJZH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2Vzcygn6L2u5pKt5Zu+5re75Yqg5oiQ5YqfJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHByaW9yaXR5U3Bhbi50ZXh0KCfkvJjlhYjnuqfvvJonK3ByaW9yaXR5KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLmxvYWREYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPXRoaXM7XHJcbiAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6Jy9jbXMvYmFubmVyX2xpc3QvJyxcclxuICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICBpZihyZXNbJ2NvZGUnXT0yMDApe1xyXG4gICAgICAgICAgICAgICAgdmFyIGJhbm5lcnMgPSByZXNbJ2RhdGEnXTtcclxuICAgICAgICAgICAgICAgIGZvcihpPTA7aTxiYW5uZXJzLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIGJhbm5lciA9IGJhbm5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVCYW5uZXJJdGVtKGJhbm5lcilcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUuY3JlYXRlQmFubmVySXRlbSA9IGZ1bmN0aW9uIChiYW5uZXIpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBiYW5uZXJMaXN0R3JvdXAgPSAkKCcuYmFubmVyLWxpc3QtZ3JvdXAnKTtcclxuICAgIHZhciB0cGwgPSB0ZW1wbGF0ZSgnYmFubmVyLWl0ZW0nLHsnYmFubmVyJzpiYW5uZXJ9KTtcclxuICAgIHZhciBiYW5uZXJJdGVtID0gbnVsbDtcclxuICAgIGlmKGJhbm5lcil7XHJcbiAgICAgICAgYmFubmVyTGlzdEdyb3VwLmFwcGVuZCh0cGwpO1xyXG4gICAgICAgIGJhbm5lckl0ZW0gPSBiYW5uZXJMaXN0R3JvdXAuZmluZCgnLmJhbm5lci1pdGVtOmxhc3QnKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGJhbm5lckxpc3RHcm91cC5wcmVwZW5kKHRwbCk7XHJcbiAgICAgICAgYmFubmVySXRlbSA9IGJhbm5lckxpc3RHcm91cC5maW5kKCcuYmFubmVyLWl0ZW06Zmlyc3QnKTtcclxuICAgIH1cclxuICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcclxuICAgIHNlbGYuYWRkUmVtb3ZlQmFubmVyRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICBzZWxmLmFkZFNhdmVCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcclxufTtcclxuXHJcbiJdfQ==
